---
title: "Final Report"
author: "Stefan Schmidt"
date: "`r Sys.Date()`"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(lubridate)
#library(plotly)
library(shiny)

mort <- 
"https://raw.githubusercontent.com/qualityland/JHU_DataViz_in_R/main/05_data_viz_capstone/data/mortality.csv"
#df <- read_csv(url(mort))
df <- read_csv("data/mortality_2022-08-11.csv")

countries <- df %>%
  select(Country) %>% 
  unique() %>% 
  arrange(Country)
```

CDR
======

Input{.sidebar}
----------------------------------------------------------------

### Crude Death Rate

Compare the *crude death rates* of different countries.

```{r}
selectInput(
  inputId = "cdrCountries",
  label = "Select countries",
  choices = countries,
  selected = c("Germany", "Switzerland", "Italy", "France"),
  multiple = TRUE)
```


Column{data-height=750}
----------------------------------------------------------------
### Crude Death Rates

```{r}
renderPlot(
  df %>% 
  filter(Country %in% input$cdrCountries) %>% 
  mutate(
    population = DTotal / RTotal,
    Year = ymd(Year, truncated = 2)) %>% 
  group_by(Year, Country) %>% 
  summarise(CDR = sum(DTotal) / sum(population), .groups = "drop") %>% 
  ggplot(aes(x = Year, y = CDR, color = Country)) +
  geom_line(size = 1) +
  ylab("Crude Death Rate")

)
```


Page 1 {data-orientation=columns}
===================================== 

Column
-------    

### Chart B

```{r}

```

Column
-------    

### Chart C

```{r}
```




Page 2
======

### Switzerland


```{r}
df %>% 
  filter(Year > 2018, CountryCode == "CHE") %>% 
  mutate(Year = factor(Year)) %>% 
  group_by(Year, CountryCode) %>% 
  ggplot(aes(x = Week, y = DTotal, color = Year)) +
  geom_line() +
  labs(
    title="Mortality in Switzerland",
    x="Week of the Year",
    y="Number of Deaths")
```


Page 3
======

Input{.sidebar}
----------------------------------------------------------------

### Chart D

```{r}

```


Column{data-height=750}
----------------------------------------------------------------
### Total Bills Passed by State, 110th Congress

```{r}
```

